<div class="modal-wrapper" (click)="close.emit()">
    <div class="overlay" (click)="close.emit()"></div>

    <div class="modal-content" (click)="$event.stopPropagation()" role="dialog" aria-modal="true"
        aria-labelledby="login-title">
        <button class="modal-close-btn" (click)="close.emit()" aria-label="Fechar">
            <app-fa-icon icon="times" />
        </button>

        <div class="modal-header">
            <div class="brand">
                <span class="brand__badge">BaitaHora</span>
                <span class="brand__scope">Acesso interno</span>
            </div>
            <h1 id="login-title" class="title">Entrar</h1>
        </div>

        <div *ngIf="errorMessage" class="alert alert--error" role="alert">
            {{ errorMessage }}
        </div>

        <form *ngIf="step === 'credentials'" [formGroup]="form" (ngSubmit)="onSubmit()" class="form">
            <div class="field">
                <app-input label="Identificador" type="text" formControlName="identify"></app-input>
                <app-field-errors label="Identificador" [control]="form.get('identify')" />
            </div>

            <div class="field">
                <app-input label="Senha" type="password" formControlName="password"></app-input>
                <app-field-errors label="Senha" [control]="form.get('password')" />
            </div>

            <button type="submit" [disabled]="form.invalid || loading" class="auth-button">
                {{ loading ? 'Entrandoâ€¦' : 'Entrar' }}
            </button>
        </form>

        <section *ngIf="step === 'choose-company'" class="choose-company">
            <p>Escolha a empresa para entrar:</p>
            <ul class="company-list">
                <li *ngFor="let c of pendingCompanies">
                    <button class="company-item" (click)="selectCompany(c.companyId)" [disabled]="loading">
                        {{ c.name }}
                    </button>
                </li>
            </ul>

            <button type="button" class="btn-back" (click)="backToCredentials()" [disabled]="loading">
                Voltar
            </button>
        </section>

        <div class="support">
            <a class="support__link" (click)="navigateToRegister($event)">
                Precisa de ajuda? Contate o administrador
            </a>
        </div>
    </div>
</div>